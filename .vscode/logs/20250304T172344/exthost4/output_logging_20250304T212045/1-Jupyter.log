code-server (1.95.3, codeocean.allenneuraldynamics.org, server-distro)
Jupyter Extension Version: 2024.10.0.
Python Extension Version: 2025.0.0.
Pylance Extension not installed.
Platform: linux (x64).
Temp Storage folder ~/capsule/code/.vscode/User/globalStorage/ms-toolsai.jupyter/version-2024.10.0
Workspace folder ~/capsule, Home = /root
21:20:47.631 [info] Starting Kernel (Python Path: /opt/conda/bin/python, Conda, 3.12.4) for '~/capsule/code/testing_code_training.ipynb' (disableUI=true)
21:20:50.635 [info] Process Execution: /opt/conda/bin/python -m pip list
21:20:50.692 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
21:20:50.696 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v35057d6ecaa98f954b10885cf2716c09f884b2c0a.json
    > cwd: //~/capsule/code
21:20:51.211 [info] Kernel successfully started
21:20:51.218 [info] Process Execution: /opt/conda/bin/python /.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/pythonFiles/printJupyterDataDir.py
21:36:49.924 [warn] Cell completed with errors [iu [Error]: 'dict' object has no attribute 'shape'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'AttributeError',
  evalue: "'dict' object has no attribute 'shape'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mAttributeError\x1B[39m                            Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[3]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43msingle_trial_licks\x1B[49m\x1B[43m.\x1B[49m\x1B[43mshape\x1B[49m\n',
    "\x1B[31mAttributeError\x1B[39m: 'dict' object has no attribute 'shape'"
  ]
}
22:03:18.198 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
22:03:19.798 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
22:03:19.804 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3b5367f09049545f2ef0b066750e28a3907ccb817.json
    > cwd: //~/capsule/code
22:03:20.293 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
22:03:40.354 [warn] Cell completed with errors [iu [Error]: SingleTrialLicks.forward() missing 1 required positional argument: 'trial_types'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: "SingleTrialLicks.forward() missing 1 required positional argument: 'trial_types'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 41\x1B[39m\n' +
      "\x1B[32m     38\x1B[39m net.device = default_parameters[\x1B[33m'\x1B[39m\x1B[33mdevice\x1B[39m\x1B[33m'\x1B[39m]\n" +
      '\x1B[32m     40\x1B[39m \x1B[38;5;66;03m#adding initial data\x1B[39;00m\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m41\x1B[39m results, cov = \x1B[43mnet\x1B[49m\x1B[43m.\x1B[49m\x1B[43mforward\x1B[49m\x1B[43m(\x1B[49m\x1B[43mtrial_average\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mtrial_types\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[32m     43\x1B[39m \x1B[38;5;66;03m#Reconsutring neural activity average over trials\x1B[39;00m\n' +
      "\x1B[32m     44\x1B[39m total_trial_average = LossTrials(trial_average, results[\x1B[33m'\x1B[39m\x1B[33mrates_alm\x1B[39m\x1B[33m'\x1B[39m])\n",
    "\x1B[31mTypeError\x1B[39m: SingleTrialLicks.forward() missing 1 required positional argument: 'trial_types'"
  ]
}
22:04:04.955 [warn] Cell completed with errors [iu [Error]: SingleTrialLicks.forward() takes 4 positional arguments but 5 were given
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: 'SingleTrialLicks.forward() takes 4 positional arguments but 5 were given',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[3]\x1B[39m\x1B[32m, line 41\x1B[39m\n' +
      "\x1B[32m     38\x1B[39m net.device = default_parameters[\x1B[33m'\x1B[39m\x1B[33mdevice\x1B[39m\x1B[33m'\x1B[39m]\n" +
      '\x1B[32m     40\x1B[39m \x1B[38;5;66;03m#adding initial data\x1B[39;00m\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m41\x1B[39m results, cov = \x1B[43mnet\x1B[49m\x1B[43m.\x1B[49m\x1B[43mforward\x1B[49m\x1B[43m(\x1B[49m\x1B[43mtrial_average\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmean_licks\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msingle_trial_licks\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mtrial_types\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[32m     43\x1B[39m \x1B[38;5;66;03m#Reconsutring neural activity average over trials\x1B[39;00m\n' +
      "\x1B[32m     44\x1B[39m total_trial_average = LossTrials(trial_average, results[\x1B[33m'\x1B[39m\x1B[33mrates_alm\x1B[39m\x1B[33m'\x1B[39m])\n",
    '\x1B[31mTypeError\x1B[39m: SingleTrialLicks.forward() takes 4 positional arguments but 5 were given'
  ]
}
22:04:31.714 [warn] Cell completed with errors [iu [Error]: name 'epoch' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'epoch' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[4]\x1B[39m\x1B[32m, line 45\x1B[39m\n' +
      '\x1B[32m     43\x1B[39m \x1B[38;5;66;03m#Reconsutring neural activity average over trials\x1B[39;00m\n' +
      "\x1B[32m     44\x1B[39m total_trial_average = LossTrials(trial_average, results[\x1B[33m'\x1B[39m\x1B[33mrates_alm\x1B[39m\x1B[33m'\x1B[39m])\n" +
      '\x1B[32m---> \x1B[39m\x1B[32m45\x1B[39m losses_trial_av[\x1B[43mepoch\x1B[49m] = total_trial_average.detach().cpu().numpy()\n',
    "\x1B[31mNameError\x1B[39m: name 'epoch' is not defined"
  ]
}
22:11:13.676 [info] Interrupt kernel execution
22:11:13.677 [info] Interrupt requested ~/capsule/code/testing_code_training.ipynb
22:11:13.677 [info] Interrupt kernel execution
22:11:13.677 [info] Interrupting kernel: python3124jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe
22:11:13.678 [info] Interrupting kernel via SIGINT
22:11:13.728 [warn] Cell completed with errors (cancelled)
22:11:13.730 [info] Interrupt requested & sent for ~/capsule/code/testing_code_training.ipynb in notebookEditor.
22:14:19.170 [info] Interrupt kernel execution
22:14:19.170 [info] Interrupt requested ~/capsule/code/testing_code_training.ipynb
22:14:19.170 [info] Interrupt kernel execution
22:14:19.170 [info] Interrupting kernel: python3124jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe
22:14:19.170 [info] Interrupting kernel via SIGINT
22:14:19.259 [warn] Cell completed with errors (cancelled)
22:14:19.260 [info] Interrupt requested & sent for ~/capsule/code/testing_code_training.ipynb in notebookEditor.
22:16:24.575 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:16:24.575 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:16:26.100 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:16:27.760 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:16:27.760 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:20:19.448 [warn] Cell completed with errors [iu [Error]: list indices must be integers or slices, not str
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: 'list indices must be integers or slices, not str',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[25]\x1B[39m\x1B[32m, line 60\x1B[39m\n' +
      '\x1B[32m     58\x1B[39m l=\x1B[32m0\x1B[39m\n' +
      '\x1B[32m     59\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names:\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m60\x1B[39m     total_average_neurons += \x1B[43mListLossesNeurons\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m(ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mneurons_average\x1B[39m\x1B[33m'\x1B[39m][s], results[\x1B[33m'\x1B[39m\x1B[33mrates_trials\x1B[39m\x1B[33m'\x1B[39m][indexes_neurons_st[l]])\n" +
      '\x1B[32m     61\x1B[39m     l+=\x1B[32m1\x1B[39m\n' +
      '\x1B[32m     62\x1B[39m total_average_neurons = total_average_neurons/total_sessions\n',
    '\x1B[31mTypeError\x1B[39m: list indices must be integers or slices, not str'
  ]
}
22:21:09.395 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[28]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      "\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[43ml\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m]\x1B[49m\n",
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
22:21:42.619 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[30]\x1B[39m\x1B[32m, line 7\x1B[39m\n' +
      '\x1B[32m      5\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m ses_name \x1B[38;5;129;01min\x1B[39;00m session_names:\n' +
      "\x1B[32m      6\x1B[39m     trial_indexes[ses_name] = ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][ses_name]\n" +
      '\x1B[32m----> \x1B[39m\x1B[32m7\x1B[39m trial_average, trial_types = \x1B[43mtoch_version_ratates_trial_types\x1B[49m\x1B[43m(\x1B[49m\x1B[43mALM_hemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     10\x1B[39m indexes_neurons_st = [ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][s] \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n" +
      '\x1B[32m     11\x1B[39m total_sessions = \x1B[38;5;28mfloat\x1B[39m(\x1B[38;5;28mlen\x1B[39m(indexes_neurons_st ))\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:154\x1B[39m, in \x1B[36mtoch_version_ratates_trial_types\x1B[39m\x1B[34m(ALM_hemi, default_parameters, session_names)\x1B[39m\n' +
      '\x1B[32m    152\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34mtoch_version_ratates_trial_types\x1B[39m(ALM_hemi, default_parameters, session_names):\n' +
      '\x1B[32m    153\x1B[39m     \x1B[38;5;66;03m#only correct trials for training\x1B[39;00m\n' +
      "\x1B[32m--> \x1B[39m\x1B[32m154\x1B[39m     rates = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mtensor\x1B[49m\x1B[43m(\x1B[49m\x1B[43mALM_hemi\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m:\x1B[49m\x1B[32;43m2\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mfloat32\x1B[49m\x1B[43m)\x1B[49m\x1B[43m.\x1B[49m\x1B[43mto\x1B[49m\x1B[43m(\x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mdevice\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m.float()\n" +
      '\x1B[32m    155\x1B[39m     \x1B[38;5;66;03m# behavior_lick_times - 0: left lick; 1: right lick\x1B[39;00m\n' +
      '\x1B[32m    156\x1B[39m     trial_types = {}\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
22:21:47.240 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[31]\x1B[39m\x1B[32m, line 7\x1B[39m\n' +
      '\x1B[32m      5\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m ses_name \x1B[38;5;129;01min\x1B[39;00m session_names:\n' +
      "\x1B[32m      6\x1B[39m     trial_indexes[ses_name] = ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][ses_name]\n" +
      '\x1B[32m----> \x1B[39m\x1B[32m7\x1B[39m trial_average, trial_types = \x1B[43mtoch_version_ratates_trial_types\x1B[49m\x1B[43m(\x1B[49m\x1B[43mALM_hemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     10\x1B[39m indexes_neurons_st = [ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][s] \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n" +
      '\x1B[32m     11\x1B[39m total_sessions = \x1B[38;5;28mfloat\x1B[39m(\x1B[38;5;28mlen\x1B[39m(indexes_neurons_st ))\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:154\x1B[39m, in \x1B[36mtoch_version_ratates_trial_types\x1B[39m\x1B[34m(ALM_hemi, default_parameters, session_names)\x1B[39m\n' +
      '\x1B[32m    152\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34mtoch_version_ratates_trial_types\x1B[39m(ALM_hemi, default_parameters, session_names):\n' +
      '\x1B[32m    153\x1B[39m     \x1B[38;5;66;03m#only correct trials for training\x1B[39;00m\n' +
      "\x1B[32m--> \x1B[39m\x1B[32m154\x1B[39m     rates = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mtensor\x1B[49m\x1B[43m(\x1B[49m\x1B[43mALM_hemi\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m:\x1B[49m\x1B[32;43m2\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mfloat32\x1B[49m\x1B[43m)\x1B[49m\x1B[43m.\x1B[49m\x1B[43mto\x1B[49m\x1B[43m(\x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mdevice\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m.float()\n" +
      '\x1B[32m    155\x1B[39m     \x1B[38;5;66;03m# behavior_lick_times - 0: left lick; 1: right lick\x1B[39;00m\n' +
      '\x1B[32m    156\x1B[39m     trial_types = {}\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
22:21:51.957 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[32]\x1B[39m\x1B[32m, line 42\x1B[39m\n' +
      '\x1B[32m     40\x1B[39m \x1B[38;5;66;03m#loading data  \x1B[39;00m\n' +
      '\x1B[32m     41\x1B[39m max_time_index = \x1B[32m275\x1B[39m \n' +
      '\x1B[32m---> \x1B[39m\x1B[32m42\x1B[39m mean_licks = \x1B[43mmean_licks_inputs\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m)\x1B[49m \n' +
      '\x1B[32m     43\x1B[39m single_trial_licks = licks_inputs(files_list, max_time_index =  max_time_index)\n' +
      '\x1B[32m     44\x1B[39m ALM_hemi= load_me_data(files_list, default_parameters, hemi=hemi, max_time_index=max_time_index)\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:22\x1B[39m, in \x1B[36mmean_licks_inputs\x1B[39m\x1B[34m(list_sessions, hemi, max_time_index, ind_start)\x1B[39m\n' +
      "\x1B[32m     20\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34mmean_licks_inputs\x1B[39m(list_sessions, hemi = \x1B[33m'\x1B[39m\x1B[33mleft\x1B[39m\x1B[33m'\x1B[39m, max_time_index = \x1B[32m350\x1B[39m, ind_start=\x1B[32m50\x1B[39m):\n" +
      '\x1B[32m     21\x1B[39m     trial_average, indexes = trial_average_all_neurons(list_sessions, hemi = hemi, max_time_index= max_time_index)\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m22\x1B[39m     trial_average = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mtensor\x1B[49m\x1B[43m(\x1B[49m\x1B[43mtrial_average\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mfloat32\x1B[49m\x1B[43m)\x1B[49m\x1B[43m.\x1B[49m\x1B[43mto\x1B[49m\x1B[43m(\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mcuda\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m)\x1B[49m.float()\n" +
      '\x1B[32m     23\x1B[39m     mean_licks =  tch.zeros_like(trial_average)\n' +
      '\x1B[32m     24\x1B[39m     ind_ses = \x1B[32m0\x1B[39m\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
22:21:56.747 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
22:21:58.519 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
22:21:58.527 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3b84a049e0050bf3782c18002afaa0d388aaa8ca0.json
    > cwd: //~/capsule/code
22:21:59.138 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
22:22:44.223 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:22:44.223 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:24:22.478 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
22:24:22.498 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
22:24:22.513 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3fee6835d5b02ba7e474b061b60b62fc1a28a0245.json
    > cwd: //~/capsule/code
22:24:23.125 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
22:25:00.028 [warn] Cell completed with errors [iu [Error]: index 633 is out of bounds for dimension 0 with size 243
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'IndexError',
  evalue: 'index 633 is out of bounds for dimension 0 with size 243',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mIndexError\x1B[39m                                Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[3]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      "\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m]\x1B[49m\n",
    '\x1B[31mIndexError\x1B[39m: index 633 is out of bounds for dimension 0 with size 243'
  ]
}
22:25:54.438 [warn] Cell completed with errors [iu [Error]: list indices must be integers or slices, not str
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: 'list indices must be integers or slices, not str',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[4]\x1B[39m\x1B[32m, line 60\x1B[39m\n' +
      '\x1B[32m     58\x1B[39m l=\x1B[32m0\x1B[39m\n' +
      '\x1B[32m     59\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names:\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m60\x1B[39m     total_average_neurons += \x1B[43mListLossesNeurons\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m(ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mneurons_average\x1B[39m\x1B[33m'\x1B[39m][s], results[\x1B[33m'\x1B[39m\x1B[33mrates_trials\x1B[39m\x1B[33m'\x1B[39m][:,:,indexes_neurons_st[l]])\n" +
      '\x1B[32m     61\x1B[39m     l+=\x1B[32m1\x1B[39m\n' +
      '\x1B[32m     62\x1B[39m total_average_neurons = total_average_neurons/\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n',
    '\x1B[31mTypeError\x1B[39m: list indices must be integers or slices, not str'
  ]
}
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:26:41.747 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
22:27:07.582 [warn] Cell completed with errors [iu [Error]: The size of tensor a (435) must match the size of tensor b (275) at non-singleton dimension 1
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'The size of tensor a (435) must match the size of tensor b (275) at non-singleton dimension 1',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[7]\x1B[39m\x1B[32m, line 60\x1B[39m\n' +
      '\x1B[32m     58\x1B[39m l=\x1B[32m0\x1B[39m\n' +
      '\x1B[32m     59\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names:\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m60\x1B[39m     total_average_neurons += \x1B[43mListLossesNeurons\x1B[49m\x1B[43m[\x1B[49m\x1B[43ml\x1B[49m\x1B[43m]\x1B[49m\x1B[43m(\x1B[49m\x1B[43mALM_hemi\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mneurons_average\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[43ml\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m\n" +
      '\x1B[32m     61\x1B[39m     l+=\x1B[32m1\x1B[39m\n' +
      '\x1B[32m     62\x1B[39m total_average_neurons = total_average_neurons/\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/losses.py:188\x1B[39m, in \x1B[36mLossAverageNeurons.__call__\x1B[39m\x1B[34m(self, av_neurons_data, rates)\x1B[39m\n' +
      '\x1B[32m    185\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34m__call__\x1B[39m(\x1B[38;5;28mself\x1B[39m, av_neurons_data, rates):\n' +
      '\x1B[32m    186\x1B[39m     \x1B[38;5;66;03m# mean spikes across neurons\x1B[39;00m\n' +
      '\x1B[32m    187\x1B[39m     av_neurons_model = \x1B[38;5;28mself\x1B[39m.compute_average_neurons(rates)\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m188\x1B[39m     total_loss = tch.mean(tch.square(\x1B[43mav_neurons_data\x1B[49m\x1B[43m \x1B[49m\x1B[43m-\x1B[49m\x1B[43m \x1B[49m\x1B[43mav_neurons_model\x1B[49m))\n' +
      '\x1B[32m    189\x1B[39m     \x1B[38;5;28;01mreturn\x1B[39;00m total_loss\n',
    '\x1B[31mRuntimeError\x1B[39m: The size of tensor a (435) must match the size of tensor b (275) at non-singleton dimension 1'
  ]
}
22:27:47.748 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
22:27:47.766 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
22:27:47.781 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3f8450a6a0aa8012e784737291551495f5767aa22.json
    > cwd: //~/capsule/code
22:27:48.391 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
22:28:14.546 [warn] Cell completed with errors [iu [Error]: name 's' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 's' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      "\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mneurons_average\x1B[39m\x1B[33m'\x1B[39m][\x1B[43ms\x1B[49m]\n",
    "\x1B[31mNameError\x1B[39m: name 's' is not defined"
  ]
}
22:28:23.175 [warn] Cell completed with errors [iu [Error]: name 'session_names' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'session_names' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[3]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      "\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mneurons_average\x1B[39m\x1B[33m'\x1B[39m][\x1B[43msession_names\x1B[49m[\x1B[32m0\x1B[39m]]\n",
    "\x1B[31mNameError\x1B[39m: name 'session_names' is not defined"
  ]
}
22:28:37.984 [warn] Cell completed with errors [iu [Error]: name 'session_names' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'session_names' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[4]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43msession_names\x1B[49m\n',
    "\x1B[31mNameError\x1B[39m: name 'session_names' is not defined"
  ]
}
22:28:55.671 [info] Interrupt kernel execution
22:28:55.671 [info] Interrupt requested ~/capsule/code/testing_code_training.ipynb
22:28:55.671 [info] Interrupt kernel execution
22:28:55.671 [info] Interrupting kernel: python3124jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe
22:28:55.672 [info] Interrupting kernel via SIGINT
22:28:55.781 [warn] Cell completed with errors (cancelled)
22:28:55.782 [info] Interrupt requested & sent for ~/capsule/code/testing_code_training.ipynb in notebookEditor.
22:33:39.704 [warn] Cell completed with errors [iu [Error]: name 'ALM' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'ALM' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[11]\x1B[39m\x1B[32m, line 62\x1B[39m\n' +
      '\x1B[32m     59\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mrange\x1B[39m(\x1B[38;5;28mlen\x1B[39m(session_names)):\n' +
      '\x1B[32m     60\x1B[39m \x1B[38;5;66;03m#trial indexes to compute\x1B[39;00m\n' +
      '\x1B[32m     61\x1B[39m     ses_name = session_names[s]\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m62\x1B[39m     trial_indexes = \x1B[43mALM\x1B[49m\n' +
      "\x1B[32m     63\x1B[39m     total_time_average += ListLossesTime[s](ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mtime_average\x1B[39m\x1B[33m'\x1B[39m][ses_name], results[\x1B[33m'\x1B[39m\x1B[33mrates_trials\x1B[39m\x1B[33m'\x1B[39m][:,:,indexes_neurons_st[s]])\n" +
      '\x1B[32m     64\x1B[39m     total_time_average = total_time_average/\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n',
    "\x1B[31mNameError\x1B[39m: name 'ALM' is not defined"
  ]
}
22:33:56.042 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[12]\x1B[39m\x1B[32m, line 62\x1B[39m\n' +
      '\x1B[32m     59\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mrange\x1B[39m(\x1B[38;5;28mlen\x1B[39m(session_names)):\n' +
      '\x1B[32m     60\x1B[39m \x1B[38;5;66;03m#trial indexes to compute\x1B[39;00m\n' +
      '\x1B[32m     61\x1B[39m     ses_name = session_names[s]\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m62\x1B[39m     total_time_average += \x1B[43mListLossesTime\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m(\x1B[49m\x1B[43mALM_hemi\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mtime_average\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43mses_name\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m\n" +
      '\x1B[32m     63\x1B[39m     total_time_average = total_time_average/\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n' +
      '\x1B[32m     64\x1B[39m     losses_time_av[epoch] = total_time_average .detach().cpu().numpy()\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/losses.py:158\x1B[39m, in \x1B[36mLossAverageTime.__call__\x1B[39m\x1B[34m(self, av_time_data, rates)\x1B[39m\n' +
      '\x1B[32m    156\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34m__call__\x1B[39m(\x1B[38;5;28mself\x1B[39m, av_time_data, rates):\n' +
      '\x1B[32m    157\x1B[39m     \x1B[38;5;66;03m# mean spikes across neurons\x1B[39;00m\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m158\x1B[39m     av_time_model = \x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mcompute_time_averages\x1B[49m\x1B[43m(\x1B[49m\x1B[43mrates\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[32m    159\x1B[39m     \x1B[38;5;66;03m#calculating losses\x1B[39;00m\n' +
      '\x1B[32m    160\x1B[39m     total_loss = tch.mean(tch.square(av_time_data - av_time_model))\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/losses.py:164\x1B[39m, in \x1B[36mLossAverageTime.compute_time_averages\x1B[39m\x1B[34m(self, rates)\x1B[39m\n' +
      '\x1B[32m    163\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34mcompute_time_averages\x1B[39m(\x1B[38;5;28mself\x1B[39m, rates):\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m164\x1B[39m     average_sample = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43msum\x1B[49m\x1B[43m(\x1B[49m\x1B[43mrates\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mind_sample_s\x1B[49m\x1B[43m:\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mind_sample_e\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mindexes_neurons\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43maxis\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m1\x1B[39;49m\x1B[43m)\x1B[49m * (\x1B[38;5;28mself\x1B[39m.dt/\x1B[32m0.65\x1B[39m) \x1B[38;5;66;03m#spikes per s\x1B[39;00m\n' +
      '\x1B[32m    165\x1B[39m     average_delay = tch.sum(rates[:, \x1B[38;5;28mself\x1B[39m.ind_sample_e:\x1B[38;5;28mself\x1B[39m.ind_delay_e, \x1B[38;5;28mself\x1B[39m.indexes_neurons], axis = \x1B[32m1\x1B[39m) * (\x1B[38;5;28mself\x1B[39m.dt/\x1B[32m1.2\x1B[39m) \x1B[38;5;66;03m#spikes per s\x1B[39;00m\n' +
      '\x1B[32m    166\x1B[39m     average_response = tch.sum(rates[:, \x1B[38;5;28mself\x1B[39m.ind_delay_e:\x1B[38;5;28mself\x1B[39m.ind_response, \x1B[38;5;28mself\x1B[39m.indexes_neurons], axis = \x1B[32m1\x1B[39m) * (\x1B[38;5;28mself\x1B[39m.dt/\x1B[38;5;28mself\x1B[39m.t_after_go) \x1B[38;5;66;03m#spikes per s\x1B[39;00m\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
22:34:04.443 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
22:34:06.200 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
22:34:06.208 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v36ed4cfd9f9f59b2bcd59b877a8a3cdbfb46dc785.json
    > cwd: //~/capsule/code
22:34:06.816 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
22:34:25.923 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
22:34:25.940 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
22:34:25.953 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v35ef7b9b1f1f4547455d00a38c993a215e7988724.json
    > cwd: //~/capsule/code
22:34:26.563 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
22:47:39.132 [info] Too many pending requests 1 for kernel 1a1298c0-78a0-49da-8bc7-8cec74a6e2ce, waiting for it to be ready.
22:47:40.501 [info] Too many pending requests 1 for kernel 1a1298c0-78a0-49da-8bc7-8cec74a6e2ce, waiting for it to be ready.
22:50:59.921 [warn] Cell completed with errors [iu [Error]: 'dict' object has no attribute 'shape'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'AttributeError',
  evalue: "'dict' object has no attribute 'shape'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mAttributeError\x1B[39m                            Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[9]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43msingle_trial_licks\x1B[49m\x1B[43m.\x1B[49m\x1B[43mshape\x1B[49m\n',
    "\x1B[31mAttributeError\x1B[39m: 'dict' object has no attribute 'shape'"
  ]
}
23:00:37.711 [warn] Cell completed with errors [iu [Error]: name 'toch_single_trials' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'toch_single_trials' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[31]\x1B[39m\x1B[32m, line 9\x1B[39m\n' +
      "\x1B[32m      6\x1B[39m     trial_indexes[ses_name] = ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][ses_name]\n" +
      '\x1B[32m      7\x1B[39m trial_average, trial_types = toch_version_ratates_trial_types(ALM_hemi, default_parameters, session_names)\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m9\x1B[39m single_trials_activity = \x1B[43mtoch_single_trials\x1B[49m(session_names, max_time_index = max_time_index)\n' +
      "\x1B[32m     11\x1B[39m indexes_neurons_st = [ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][s] \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n" +
      '\x1B[32m     12\x1B[39m total_sessions = \x1B[38;5;28mlen\x1B[39m(indexes_neurons_st )\n',
    "\x1B[31mNameError\x1B[39m: name 'toch_single_trials' is not defined"
  ]
}
23:00:45.868 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:00:47.646 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:00:47.655 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3521b911efd4597cd9ae0767c90d1f61065b36340.json
    > cwd: //~/capsule/code
23:00:48.270 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:01:04.966 [warn] Cell completed with errors [iu [Error]: name 'session_names' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'session_names' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 9\x1B[39m\n' +
      "\x1B[32m      6\x1B[39m     trial_indexes[ses_name] = ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][ses_name]\n" +
      '\x1B[32m      7\x1B[39m trial_average, trial_types = toch_version_ratates_trial_types(ALM_hemi, default_parameters, session_names)\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m9\x1B[39m single_trials_activity = \x1B[43mtoch_single_trials\x1B[49m\x1B[43m(\x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     11\x1B[39m indexes_neurons_st = [ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][s] \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n" +
      '\x1B[32m     12\x1B[39m total_sessions = \x1B[38;5;28mlen\x1B[39m(indexes_neurons_st )\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:168\x1B[39m, in \x1B[36mtoch_single_trials\x1B[39m\x1B[34m(dsession_names, max_time_index)\x1B[39m\n' +
      '\x1B[32m    165\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34mtoch_single_trials\x1B[39m(dsession_names, max_time_index = \x1B[32m350\x1B[39m):\n' +
      '\x1B[32m    166\x1B[39m     \x1B[38;5;66;03m#only correct trials for training\x1B[39;00m\n' +
      '\x1B[32m    167\x1B[39m     single_trials_activity= {}\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m168\x1B[39m     \x1B[38;5;28;01mfor\x1B[39;00m ses_name \x1B[38;5;129;01min\x1B[39;00m \x1B[43msession_names\x1B[49m:\n' +
      "\x1B[32m    169\x1B[39m         data = pickle.load(\x1B[38;5;28mopen\x1B[39m(path_dandi + ses_name.rstrip(\x1B[33m'\x1B[39m\x1B[33mp\x1B[39m\x1B[33m'\x1B[39m) + \x1B[33m'\x1B[39m\x1B[33m_all_spikes.p\x1B[39m\x1B[33m'\x1B[39m, \x1B[33m'\x1B[39m\x1B[33mrb\x1B[39m\x1B[33m'\x1B[39m))\n" +
      "\x1B[32m    170\x1B[39m         data_tensor = tch.tensor(data[:,\x1B[32m0\x1B[39m:max_time_index,:], dtype = tch.float32).to(default_parameters[\x1B[33m'\x1B[39m\x1B[33mdevice\x1B[39m\x1B[33m'\x1B[39m]).float()\n",
    "\x1B[31mNameError\x1B[39m: name 'session_names' is not defined"
  ]
}
23:01:30.573 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:01:30.591 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:01:30.605 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v39162524bf936302078442b26a3eb8cedb3063b8a.json
    > cwd: //~/capsule/code
23:01:31.217 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:01:47.708 [warn] Cell completed with errors [iu [Error]: [Errno 2] No such file or directory: '../data/MAPDANDI_Functional/sub-456772_ses-20191120T115527._all_spikes.p'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'FileNotFoundError',
  evalue: "[Errno 2] No such file or directory: '../data/MAPDANDI_Functional/sub-456772_ses-20191120T115527._all_spikes.p'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mFileNotFoundError\x1B[39m                         Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 9\x1B[39m\n' +
      "\x1B[32m      6\x1B[39m     trial_indexes[ses_name] = ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][ses_name]\n" +
      '\x1B[32m      7\x1B[39m trial_average, trial_types = toch_version_ratates_trial_types(ALM_hemi, default_parameters, session_names)\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m9\x1B[39m single_trials_activity = \x1B[43mtoch_single_trials\x1B[49m\x1B[43m(\x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     11\x1B[39m indexes_neurons_st = [ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][s] \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n" +
      '\x1B[32m     12\x1B[39m total_sessions = \x1B[38;5;28mlen\x1B[39m(indexes_neurons_st )\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:169\x1B[39m, in \x1B[36mtoch_single_trials\x1B[39m\x1B[34m(session_names, max_time_index)\x1B[39m\n' +
      '\x1B[32m    167\x1B[39m single_trials_activity= {}\n' +
      '\x1B[32m    168\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m ses_name \x1B[38;5;129;01min\x1B[39;00m session_names:\n' +
      "\x1B[32m--> \x1B[39m\x1B[32m169\x1B[39m     data = pickle.load(\x1B[38;5;28;43mopen\x1B[39;49m\x1B[43m(\x1B[49m\x1B[43mpath_dandi\x1B[49m\x1B[43m \x1B[49m\x1B[43m+\x1B[49m\x1B[43m \x1B[49m\x1B[43mses_name\x1B[49m\x1B[43m.\x1B[49m\x1B[43mrstrip\x1B[49m\x1B[43m(\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mp\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m \x1B[49m\x1B[43m+\x1B[49m\x1B[43m \x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43m_all_spikes.p\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrb\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m)\x1B[49m)\n" +
      "\x1B[32m    170\x1B[39m     data_tensor = tch.tensor(data[:,\x1B[32m0\x1B[39m:max_time_index,:], dtype = tch.float32).to(default_parameters[\x1B[33m'\x1B[39m\x1B[33mdevice\x1B[39m\x1B[33m'\x1B[39m]).float()\n" +
      '\x1B[32m    171\x1B[39m     single_trials_activity[ses_name] = data_tensor\n',
    "\x1B[31mFileNotFoundError\x1B[39m: [Errno 2] No such file or directory: '../data/MAPDANDI_Functional/sub-456772_ses-20191120T115527._all_spikes.p'"
  ]
}
23:02:02.729 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:02:02.748 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:02:02.762 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3c49cdf73ab3db9ed1af67cf6ba67dc7e6a726ae0.json
    > cwd: //~/capsule/code
23:02:03.371 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:02:20.111 [warn] Cell completed with errors [iu [Error]: name 'default_parameters' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'default_parameters' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 9\x1B[39m\n' +
      "\x1B[32m      6\x1B[39m     trial_indexes[ses_name] = ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][ses_name]\n" +
      '\x1B[32m      7\x1B[39m trial_average, trial_types = toch_version_ratates_trial_types(ALM_hemi, default_parameters, session_names)\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m9\x1B[39m single_trials_activity = \x1B[43mtoch_single_trials\x1B[49m\x1B[43m(\x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     11\x1B[39m indexes_neurons_st = [ALM_hemi[\x1B[33m'\x1B[39m\x1B[33mindexes\x1B[39m\x1B[33m'\x1B[39m][s] \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n" +
      '\x1B[32m     12\x1B[39m total_sessions = \x1B[38;5;28mlen\x1B[39m(indexes_neurons_st )\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:170\x1B[39m, in \x1B[36mtoch_single_trials\x1B[39m\x1B[34m(session_names, max_time_index)\x1B[39m\n' +
      '\x1B[32m    168\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m ses_name \x1B[38;5;129;01min\x1B[39;00m session_names:\n' +
      "\x1B[32m    169\x1B[39m     data = pickle.load(\x1B[38;5;28mopen\x1B[39m(path_dandi + ses_name.rstrip(\x1B[33m'\x1B[39m\x1B[33m.p\x1B[39m\x1B[33m'\x1B[39m) + \x1B[33m'\x1B[39m\x1B[33m_all_spikes.p\x1B[39m\x1B[33m'\x1B[39m, \x1B[33m'\x1B[39m\x1B[33mrb\x1B[39m\x1B[33m'\x1B[39m))\n" +
      "\x1B[32m--> \x1B[39m\x1B[32m170\x1B[39m     data_tensor = tch.tensor(data[:,\x1B[32m0\x1B[39m:max_time_index,:], dtype = tch.float32).to(\x1B[43mdefault_parameters\x1B[49m[\x1B[33m'\x1B[39m\x1B[33mdevice\x1B[39m\x1B[33m'\x1B[39m]).float()\n" +
      '\x1B[32m    171\x1B[39m     single_trials_activity[ses_name] = data_tensor\n' +
      '\x1B[32m    172\x1B[39m \x1B[38;5;28;01mreturn\x1B[39;00m single_trials_activity\n',
    "\x1B[31mNameError\x1B[39m: name 'default_parameters' is not defined"
  ]
}
23:02:58.300 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:02:58.319 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:02:58.331 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3a449606e28884606e41d5ef8ba5b6a1946e63e43.json
    > cwd: //~/capsule/code
23:02:58.941 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:08:23.563 [warn] Cell completed with errors [iu [Error]: name 'ind_go' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'ind_go' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[10]\x1B[39m\x1B[32m, line 2\x1B[39m\n' +
      "\x1B[32m      1\x1B[39m plt.plot(tch.mean(single_trials_activity[\x1B[33m'\x1B[39m\x1B[33msub-456772_ses-20191120T115527.p\x1B[39m\x1B[33m'\x1B[39m], axis=\x1B[32m0\x1B[39m).detach().cpu().numpy())\n" +
      '\x1B[32m----> \x1B[39m\x1B[32m2\x1B[39m plt.axvline(x = \x1B[43mind_go\x1B[49m)\n' +
      '\x1B[32m      3\x1B[39m plt.axvline(x = ind_go+\x1B[32m10\x1B[39m)\n',
    "\x1B[31mNameError\x1B[39m: name 'ind_go' is not defined"
  ]
}
23:19:46.166 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:19:47.974 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:19:47.983 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v36e00ea1324411da2ee2263d77f5455de0c98a0fb.json
    > cwd: //~/capsule/code
23:19:48.593 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:20:33.829 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:20:33.829 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:20:33.829 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:20:35.549 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:20:35.549 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:20:38.511 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:20:38.511 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:23:02.148 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[8]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      "\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mListLossesTime\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m(\x1B[49m\x1B[43msingle_trials_activity\x1B[49m\x1B[43m[\x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m\n",
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/losses.py:159\x1B[39m, in \x1B[36mLossAverageTime.__call__\x1B[39m\x1B[34m(self, rates_data, rates_model)\x1B[39m\n' +
      '\x1B[32m    157\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34m__call__\x1B[39m(\x1B[38;5;28mself\x1B[39m, rates_data, rates_model):\n' +
      '\x1B[32m    158\x1B[39m     \x1B[38;5;66;03m# mean spikes across neurons\x1B[39;00m\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m159\x1B[39m     av_time_model = \x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mcompute_time_averages\x1B[49m\x1B[43m(\x1B[49m\x1B[43mrates_model\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[32m    160\x1B[39m     av_time_data = \x1B[38;5;28mself\x1B[39m.compute_time_averages(rates_data)\n' +
      '\x1B[32m    161\x1B[39m     \x1B[38;5;66;03m#calculating losses\x1B[39;00m\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/losses.py:166\x1B[39m, in \x1B[36mLossAverageTime.compute_time_averages\x1B[39m\x1B[34m(self, rates)\x1B[39m\n' +
      '\x1B[32m    165\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34mcompute_time_averages\x1B[39m(\x1B[38;5;28mself\x1B[39m, rates):\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m166\x1B[39m     average_sample = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43msum\x1B[49m\x1B[43m(\x1B[49m\x1B[43mrates\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mind_sample_s\x1B[49m\x1B[43m:\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mind_sample_e\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mindexes_neurons\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43maxis\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m1\x1B[39;49m\x1B[43m)\x1B[49m * (\x1B[38;5;28mself\x1B[39m.dt/\x1B[32m0.65\x1B[39m) \x1B[38;5;66;03m#spikes per s\x1B[39;00m\n' +
      '\x1B[32m    167\x1B[39m     average_delay1 = tch.sum(rates[:, \x1B[38;5;28mself\x1B[39m.ind_sample_e:\x1B[38;5;28mself\x1B[39m.ind_delay_e1, \x1B[38;5;28mself\x1B[39m.indexes_neurons], axis = \x1B[32m1\x1B[39m) * (\x1B[38;5;28mself\x1B[39m.dt/\x1B[32m.6\x1B[39m) \x1B[38;5;66;03m#spikes per s\x1B[39;00m\n' +
      '\x1B[32m    168\x1B[39m     average_delay2 = tch.sum(rates[:, \x1B[38;5;28mself\x1B[39m.ind_delay_e1:\x1B[38;5;28mself\x1B[39m.ind_delay_e2, \x1B[38;5;28mself\x1B[39m.indexes_neurons], axis = \x1B[32m1\x1B[39m) * (\x1B[38;5;28mself\x1B[39m.dt/\x1B[32m.6\x1B[39m) \x1B[38;5;66;03m#spikes per s\x1B[39;00m\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
23:24:05.395 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:24:16.360 [warn] Cell completed with errors [iu [Error]: type object 'LossAverageTime' has no attribute 'indexes'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'AttributeError',
  evalue: "type object 'LossAverageTime' has no attribute 'indexes'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mAttributeError\x1B[39m                            Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[9]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mLossAverageTime\x1B[49m\x1B[43m.\x1B[49m\x1B[43mindexes\x1B[49m\n',
    "\x1B[31mAttributeError\x1B[39m: type object 'LossAverageTime' has no attribute 'indexes'"
  ]
}
23:24:33.931 [warn] Cell completed with errors [iu [Error]: type object 'LossAverageTime' has no attribute 'indexes_neurons'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'AttributeError',
  evalue: "type object 'LossAverageTime' has no attribute 'indexes_neurons'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mAttributeError\x1B[39m                            Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[10]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mLossAverageTime\x1B[49m\x1B[43m.\x1B[49m\x1B[43mindexes_neurons\x1B[49m\n',
    "\x1B[31mAttributeError\x1B[39m: type object 'LossAverageTime' has no attribute 'indexes_neurons'"
  ]
}
23:24:41.095 [warn] Cell completed with errors [iu [Error]: type 'LossAverageTime' is not subscriptable
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: "type 'LossAverageTime' is not subscriptable",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[11]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mLossAverageTime\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m.indexes_neurons\n',
    "\x1B[31mTypeError\x1B[39m: type 'LossAverageTime' is not subscriptable"
  ]
}
23:24:50.561 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:24:50.581 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:24:50.595 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3af4b76589282477b0634299a049906ab2cea4cf2.json
    > cwd: //~/capsule/code
23:24:51.206 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:25:20.028 [warn] Cell completed with errors [iu [Error]: type 'LossAverageTime' is not subscriptable
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: "type 'LossAverageTime' is not subscriptable",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[3]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mLossAverageTime\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m.indexes_neurons\n',
    "\x1B[31mTypeError\x1B[39m: type 'LossAverageTime' is not subscriptable"
  ]
}
23:25:26.508 [warn] Cell completed with errors [iu [Error]: type 'LossAverageTime' is not subscriptable
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: "type 'LossAverageTime' is not subscriptable",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[4]\x1B[39m\x1B[32m, line 1\x1B[39m\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m1\x1B[39m \x1B[43mLossAverageTime\x1B[49m\x1B[43m[\x1B[49m\x1B[32;43m0\x1B[39;49m\x1B[43m]\x1B[49m\n',
    "\x1B[31mTypeError\x1B[39m: type 'LossAverageTime' is not subscriptable"
  ]
}
23:25:52.523 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:25:52.523 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:25:52.523 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:25:52.523 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:25:52.523 [info] Disposing request as the cell (-1) was deleted ~/capsule/code/testing_code_training.ipynb
23:27:37.939 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:27:37.958 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:27:37.972 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3b7f9dedbba68a1cc9d0a8446adfab01f090f33ef.json
    > cwd: //~/capsule/code
23:27:38.582 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:29:46.034 [warn] Cell completed with errors [iu [Error]: name 'S' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'S' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[6]\x1B[39m\x1B[32m, line 61\x1B[39m\n' +
      '\x1B[32m     58\x1B[39m total_time_average = \x1B[32m0\x1B[39m\n' +
      '\x1B[32m     59\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mrange\x1B[39m(\x1B[38;5;28mlen\x1B[39m(session_names)):\n' +
      '\x1B[32m     60\x1B[39m     \x1B[38;5;66;03m#trial indexes to compute\x1B[39;00m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m61\x1B[39m     total_time_average += ListLossesTime[s](single_trials_activity[session_names[s]], results[\x1B[33m'\x1B[39m\x1B[33mrates_trials\x1B[39m\x1B[33m'\x1B[39m][:,:,indexes_neurons_st[\x1B[43mS\x1B[49m]])\n" +
      '\x1B[32m     62\x1B[39m total_time_average = total_time_average/\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n' +
      '\x1B[32m     63\x1B[39m losses_time_av[epoch] = total_time_average .detach().cpu().numpy()\n',
    "\x1B[31mNameError\x1B[39m: name 'S' is not defined"
  ]
}
23:33:25.588 [warn] Cell completed with errors [iu [Error]: name 'epoch_average2' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'epoch_average2' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[17]\x1B[39m\x1B[32m, line 2\x1B[39m\n' +
      '\x1B[32m      1\x1B[39m plt.plot(epoch_average.detach().cpu().numpy()[\x1B[32m0\x1B[39m,:,\x1B[32m3\x1B[39m])\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m2\x1B[39m plt.plot(\x1B[43mepoch_average2\x1B[49m.detach().cpu().numpy()[\x1B[32m0\x1B[39m,:,\x1B[32m3\x1B[39m])\n',
    "\x1B[31mNameError\x1B[39m: name 'epoch_average2' is not defined"
  ]
}
23:33:32.886 [warn] Cell completed with errors [iu [Error]: 'dict' object has no attribute 'detach'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'AttributeError',
  evalue: "'dict' object has no attribute 'detach'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mAttributeError\x1B[39m                            Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[19]\x1B[39m\x1B[32m, line 2\x1B[39m\n' +
      '\x1B[32m      1\x1B[39m plt.plot(epoch_average.detach().cpu().numpy()[\x1B[32m0\x1B[39m,:,\x1B[32m3\x1B[39m])\n' +
      '\x1B[32m----> \x1B[39m\x1B[32m2\x1B[39m plt.plot(\x1B[43mepoch_average2\x1B[49m\x1B[43m.\x1B[49m\x1B[43mdetach\x1B[49m().cpu().numpy()[\x1B[32m0\x1B[39m,:,\x1B[32m3\x1B[39m])\n',
    "\x1B[31mAttributeError\x1B[39m: 'dict' object has no attribute 'detach'"
  ]
}
23:51:52.038 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:51:53.822 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:51:53.831 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v342ac8484b7fb510096adb081aee884cf18b1e23e.json
    > cwd: //~/capsule/code
23:51:54.445 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:52:13.411 [warn] Cell completed with errors [iu [Error]: list indices must be integers or slices, not str
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: 'list indices must be integers or slices, not str',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 35\x1B[39m\n' +
      '\x1B[32m     33\x1B[39m ListLossesTime = [LossAverageTime(default_parameters) \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n' +
      '\x1B[32m     34\x1B[39m \x1B[38;5;66;03m#average over neurons\x1B[39;00m\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m35\x1B[39m ListLossesCoding = [SelectivitySingleTrialLoss(trial_average, default_parameters, \x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m) \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m session_names]\n' +
      '\x1B[32m     38\x1B[39m n_trials = \x1B[32m0\x1B[39m\n' +
      '\x1B[32m     39\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m t_type \x1B[38;5;129;01min\x1B[39;00m trial_types:\n',
    '\x1B[31mTypeError\x1B[39m: list indices must be integers or slices, not str'
  ]
}
23:55:09.931 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:55:09.951 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:55:09.965 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3836845b51c51eb2f6ad31eae2aae5f6859a75039.json
    > cwd: //~/capsule/code
23:55:10.574 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
23:55:30.554 [warn] Cell completed with errors [iu [Error]: SelectivitySingleTrialLoss.__call__() missing 1 required positional argument: 'rates_model'
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'TypeError',
  evalue: "SelectivitySingleTrialLoss.__call__() missing 1 required positional argument: 'rates_model'",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mTypeError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 69\x1B[39m\n' +
      '\x1B[32m     66\x1B[39m total_coding_average = \x1B[32m0\x1B[39m\n' +
      '\x1B[32m     67\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mrange\x1B[39m(\x1B[38;5;28mlen\x1B[39m(session_names)):\n' +
      '\x1B[32m     68\x1B[39m     \x1B[38;5;66;03m#trial indexes to compute\x1B[39;00m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m69\x1B[39m     total_coding_average += \x1B[43mListLossesCoding\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m(\x1B[49m\x1B[43msingle_trials_activity\x1B[49m\x1B[43m[\x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m\n" +
      '\x1B[32m     70\x1B[39m total_coding_average  = total_coding_average /\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n' +
      '\x1B[32m     71\x1B[39m losses_coding_av[epoch] = total_coding_average.detach().cpu().numpy()\n',
    "\x1B[31mTypeError\x1B[39m: SelectivitySingleTrialLoss.__call__() missing 1 required positional argument: 'rates_model'"
  ]
}
23:55:59.461 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
23:55:59.479 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
23:55:59.494 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v39deaf40b66fc8709e5ad69817a69786df4231e0f.json
    > cwd: //~/capsule/code
23:56:00.103 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
00:00:19.117 [warn] Cell completed with errors [iu [Error]: name 'c_neurons_av' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'c_neurons_av' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[3]\x1B[39m\x1B[32m, line 87\x1B[39m\n' +
      '\x1B[32m     85\x1B[39m     loss_reconstruction = total_trial_average\n' +
      '\x1B[32m     86\x1B[39m \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m87\x1B[39m     loss_reconstruction = \x1B[43mc_neurons_av\x1B[49m * total_average_neurons + c_trials_av * total_coding_average + c_time_av * total_time_average\n' +
      '\x1B[32m     88\x1B[39m total_loss = \x1B[32m0.7\x1B[39m * loss_reconstruction + \x1B[32m0.3\x1B[39m * loss_factors\n' +
      '\x1B[32m     89\x1B[39m total_loss= total_loss/ optimize_every\n',
    "\x1B[31mNameError\x1B[39m: name 'c_neurons_av' is not defined"
  ]
}
00:02:19.339 [warn] Cell completed with errors [iu [Error]: name 'info' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'info' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[5]\x1B[39m\x1B[32m, line 98\x1B[39m\n' +
      '\x1B[32m     96\x1B[39m sel_loss = np.mean(losses_sel[\x1B[38;5;28mmax\x1B[39m(\x1B[32m0\x1B[39m, epoch-\x1B[32m100\x1B[39m):epoch])\n' +
      '\x1B[32m     97\x1B[39m weights_loss = np.mean(losses_weights[\x1B[38;5;28mmax\x1B[39m(\x1B[32m0\x1B[39m, epoch-\x1B[32m100\x1B[39m):epoch])\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m98\x1B[39m \x1B[38;5;28mprint\x1B[39m(\x1B[43minfo\x1B[49m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33mEpoch \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mepoch\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Trial Average = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmean_trial\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Time Average = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmean_time\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Neurons Average = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmean_coding\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+ \x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m| Selectivity = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00msel_loss\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Orthogonality = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mnp.mean(weights_loss)\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m)\n" +
      '\x1B[32m    100\x1B[39m \x1B[38;5;66;03m#optimizing\x1B[39;00m\n' +
      '\x1B[32m    101\x1B[39m optimizer.zero_grad()\n',
    "\x1B[31mNameError\x1B[39m: name 'info' is not defined"
  ]
}
00:02:33.462 [warn] Cell completed with errors [iu [Error]: name 'optimizer' is not defined
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'NameError',
  evalue: "name 'optimizer' is not defined",
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mNameError\x1B[39m                                 Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[6]\x1B[39m\x1B[32m, line 101\x1B[39m\n' +
      "\x1B[32m     98\x1B[39m \x1B[38;5;28mprint\x1B[39m(\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33mEpoch \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mepoch\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Trial Average = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmean_trial\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Time Average = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmean_time\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Neurons Average = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmean_coding\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+ \x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m| Selectivity = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00msel_loss\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m+\x1B[33mf\x1B[39m\x1B[33m'\x1B[39m\x1B[33m | Orthogonality = \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mnp.mean(weights_loss)\x1B[38;5;132;01m}\x1B[39;00m\x1B[33m'\x1B[39m)\n" +
      '\x1B[32m    100\x1B[39m \x1B[38;5;66;03m#optimizing\x1B[39;00m\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m101\x1B[39m \x1B[43moptimizer\x1B[49m.zero_grad()\n' +
      '\x1B[32m    102\x1B[39m total_loss.backward()\n' +
      '\x1B[32m    103\x1B[39m optimizer.step()\n',
    "\x1B[31mNameError\x1B[39m: name 'optimizer' is not defined"
  ]
}
00:03:32.217 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
00:03:33.994 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
00:03:34.002 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3d4eb7014debb41423a5a110a82a0ad28b2a57ade.json
    > cwd: //~/capsule/code
00:03:34.612 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
00:04:12.901 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
00:04:12.916 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
00:04:12.926 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v35de40561908b4a649e2b8414cdc40df000b3aec6.json
    > cwd: //~/capsule/code
00:04:13.370 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
00:04:59.599 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
00:04:59.620 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
00:04:59.634 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3883cf8fc4b734e9a65579450a7870c653f13999d.json
    > cwd: //~/capsule/code
00:05:00.244 [info] Restarted 5fb0faa2-e803-4bc1-ada2-1ba3edc52f6a
00:37:05.256 [info] Dispose Kernel '~/capsule/code/testing_code_training.ipynb' associated with '~/capsule/code/testing_code_training.ipynb'
00:37:05.294 [warn] Failed to delete connection file file:///~/.local/share/jupyter/runtime/kernel-v3883cf8fc4b734e9a65579450a7870c653f13999d.json for pid 29598 [Canceled (FileSystemError): Canceled
	at Qi.e (file:///.code-server/code-server-4.95.3-linux-amd64/lib/vscode/out/vs/workbench/api/node/extensionHostProcess.js:114:9853)
	at Object.stat (file:///.code-server/code-server-4.95.3-linux-amd64/lib/vscode/out/vs/workbench/api/node/extensionHostProcess.js:114:7007)
	at async Bc.delete (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:239:15448)
	at async /.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:303:469] {
  code: 'Unknown'
}
