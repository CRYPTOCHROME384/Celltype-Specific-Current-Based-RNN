code-server (1.95.3, codeocean.allenneuraldynamics.org, server-distro)
Jupyter Extension Version: 2024.10.0.
Python Extension Version: 2025.0.0.
Pylance Extension not installed.
Platform: linux (x64).
Temp Storage folder ~/capsule/code/.vscode/User/globalStorage/ms-toolsai.jupyter/version-2024.10.0
Workspace folder ~/capsule, Home = /root
16:53:34.956 [info] Starting Kernel (Python Path: /opt/conda/bin/python, Conda, 3.12.4) for '~/capsule/code/testing_code_training.ipynb' (disableUI=false)
16:53:36.589 [info] Process Execution: /opt/conda/bin/python -m pip list
16:53:36.596 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
16:53:36.604 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v379012c1b137c6aac28477387e8a3314bf6a30b05.json
    > cwd: //~/capsule/code
16:53:36.610 [warn] Stderr output when getting ipykernel version & path Traceback (most recent call last):
    File "<string>", line 1, in <module>
    ModuleNotFoundError: No module named 'ipykernel' for /opt/conda/bin/python
16:53:36.622 [error] Disposing kernel process due to an error Error: The kernel died. Error: /opt/conda/bin/python: No module named ipykernel_launcher... View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe./opt/conda/python./opt/conda/python.-m#ipykernel_launcher
    > Interpreter Id = /opt/conda/bin/python
    > at ChildProcess.<anonymous> (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:299:44541)
    > stdErr = /opt/conda/bin/python: No module named ipykernel_launcher
16:53:36.624 [error] Failed to connect raw kernel session: Error: The kernel died. Error: /opt/conda/bin/python: No module named ipykernel_launcher... View Jupyter [log](command:jupyter.viewOutput) for further details.
16:53:36.625 [error] Failed to connect raw kernel session: Error: The kernel died. Error: /opt/conda/bin/python: No module named ipykernel_launcher... View Jupyter [log](command:jupyter.viewOutput) for further details.
16:53:36.625 [warn] Failed to shutdown kernel, .jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe./opt/conda/python./opt/conda/python.-m#ipykernel_launcher [TypeError: Cannot read properties of undefined (reading 'dispose')
	at U_.shutdown (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:304:13745)
	at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
	at async W_.shutdown (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:304:22578)]
16:53:36.626 [warn] Error occurred while trying to start the kernel, options.disableUI=false Error: The kernel died. Error: /opt/conda/bin/python: No module named ipykernel_launcher... View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe./opt/conda/python./opt/conda/python.-m#ipykernel_launcher
    > Interpreter Id = /opt/conda/bin/python
    > at ChildProcess.<anonymous> (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:299:44541)
    > stdErr = /opt/conda/bin/python: No module named ipykernel_launcher
16:53:36.626 [warn] Kernel Error, context = start Error: The kernel died. Error: /opt/conda/bin/python: No module named ipykernel_launcher... View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe./opt/conda/python./opt/conda/python.-m#ipykernel_launcher
    > Interpreter Id = /opt/conda/bin/python
    > at ChildProcess.<anonymous> (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:299:44541)
    > stdErr = /opt/conda/bin/python: No module named ipykernel_launcher
16:53:36.634 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel;print('6af208d0-cb9c-427f-b937-ff563e17efdf')"
16:53:36.646 [info] Check & install missing Kernel dependencies for /opt/conda/bin/python, ui.disabled=false for resource '~/capsule/code/testing_code_training.ipynb'
16:53:36.653 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel;print('6af208d0-cb9c-427f-b937-ff563e17efdf')"
16:53:37.179 [info] Process Execution: /conda install -c conda-forge --name base ipykernel -y
16:54:07.516 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel;print('6af208d0-cb9c-427f-b937-ff563e17efdf')"
16:54:07.690 [info] Dispose Kernel '~/capsule/code/testing_code_training.ipynb' associated with '~/capsule/code/testing_code_training.ipynb'
16:54:07.698 [info] Process Execution: /opt/conda/bin/python -m pip list
16:54:07.698 [info] Starting Kernel (Python Path: /opt/conda/bin/python, Conda, 3.12.4) for '~/capsule/code/testing_code_training.ipynb' (disableUI=false)
16:54:07.708 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
16:54:07.719 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3c24bf05e79727484ff402ef549b0a4c7b01c8534.json
    > cwd: //~/capsule/code
16:54:08.383 [info] Kernel successfully started
16:54:43.978 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 27\x1B[39m\n' +
      '\x1B[32m     24\x1B[39m max_epochs = \x1B[32m400000\x1B[39m\n' +
      '\x1B[32m     25\x1B[39m max_time_index = \x1B[32m275\x1B[39m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m27\x1B[39m \x1B[43mtrain\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43msub-442571_ses-20190228T140832.p\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m=\x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m=\x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m=\x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mlr\x1B[49m\x1B[43m=\x1B[49m\x1B[32;43m5e-4\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mtest_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m50\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43moptimize_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m1\x1B[39;49m\x1B[43m)\x1B[49m\n",
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/training.py:72\x1B[39m, in \x1B[36mtrain\x1B[39m\x1B[34m(files_list, session_names, net_params, n_pop, hemi, max_time_index, lr, max_epochs, test_every, optimize_every, info)\x1B[39m\n' +
      '\x1B[32m     70\x1B[39m     n_trials+=\x1B[38;5;28mlen\x1B[39m(trial_types[t_type])\n' +
      "\x1B[32m     71\x1B[39m default_parameters[\x1B[33m'\x1B[39m\x1B[33mn_trials\x1B[39m\x1B[33m'\x1B[39m] = n_trials\n" +
      '\x1B[32m---> \x1B[39m\x1B[32m72\x1B[39m net = \x1B[43mSingleTrialLicks\x1B[49m\x1B[43m(\x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     73\x1B[39m net.device = default_parameters[\x1B[33m'\x1B[39m\x1B[33mdevice\x1B[39m\x1B[33m'\x1B[39m]\n" +
      '\x1B[32m     74\x1B[39m \x1B[38;5;28;01mif\x1B[39;00m net_params \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/model.py:61\x1B[39m, in \x1B[36mSingleTrialLicks.__init__\x1B[39m\x1B[34m(self, params_dict, indexes_neurons_st)\x1B[39m\n' +
      '\x1B[32m     58\x1B[39m \x1B[38;5;28mself\x1B[39m.build_communication_recurrent()\n' +
      '\x1B[32m     60\x1B[39m \x1B[38;5;66;03m#perturbing the model\x1B[39;00m\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m61\x1B[39m \x1B[38;5;28mself\x1B[39m.input_test = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mzeros\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mn_neurons_alm\x1B[49m\x1B[43m)\x1B[49m\x1B[43m.\x1B[49m\x1B[43mto\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mdevice\x1B[49m\x1B[43m)\x1B[49m     \n' +
      '\x1B[32m     62\x1B[39m \x1B[38;5;28mself\x1B[39m.to(\x1B[38;5;28mself\x1B[39m.device)\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
16:56:17.326 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[3]\x1B[39m\x1B[32m, line 27\x1B[39m\n' +
      '\x1B[32m     24\x1B[39m max_epochs = \x1B[32m400000\x1B[39m\n' +
      '\x1B[32m     25\x1B[39m max_time_index = \x1B[32m275\x1B[39m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m27\x1B[39m \x1B[43mtrain\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43msub-442571_ses-20190228T140832.p\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m=\x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m=\x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m=\x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mlr\x1B[49m\x1B[43m=\x1B[49m\x1B[32;43m5e-4\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mtest_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m50\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43moptimize_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m1\x1B[39;49m\x1B[43m)\x1B[49m\n",
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/training.py:29\x1B[39m, in \x1B[36mtrain\x1B[39m\x1B[34m(files_list, session_names, net_params, n_pop, hemi, max_time_index, lr, max_epochs, test_every, optimize_every, info)\x1B[39m\n' +
      '\x1B[32m     27\x1B[39m c_sel = \x1B[32m0.5\x1B[39m\n' +
      '\x1B[32m     28\x1B[39m \x1B[38;5;66;03m#loading data    \x1B[39;00m\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m29\x1B[39m mean_licks = \x1B[43mmean_licks_inputs\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m)\x1B[49m \n' +
      '\x1B[32m     30\x1B[39m single_trial_licks = licks_inputs(files_list, max_time_index =  max_time_index)\n' +
      '\x1B[32m     31\x1B[39m ALM_hemi= load_me_data(files_list, default_parameters, hemi=hemi, max_time_index=max_time_index)\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:22\x1B[39m, in \x1B[36mmean_licks_inputs\x1B[39m\x1B[34m(list_sessions, hemi, max_time_index, ind_start)\x1B[39m\n' +
      "\x1B[32m     20\x1B[39m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[34mmean_licks_inputs\x1B[39m(list_sessions, hemi = \x1B[33m'\x1B[39m\x1B[33mleft\x1B[39m\x1B[33m'\x1B[39m, max_time_index = \x1B[32m350\x1B[39m, ind_start=\x1B[32m50\x1B[39m):\n" +
      '\x1B[32m     21\x1B[39m     trial_average, indexes = trial_average_all_neurons(list_sessions, hemi = hemi, max_time_index= max_time_index)\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m22\x1B[39m     trial_average = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mtensor\x1B[49m\x1B[43m(\x1B[49m\x1B[43mtrial_average\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mfloat32\x1B[49m\x1B[43m)\x1B[49m\x1B[43m.\x1B[49m\x1B[43mto\x1B[49m\x1B[43m(\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mcuda\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m)\x1B[49m.float()\n" +
      '\x1B[32m     23\x1B[39m     mean_licks =  tch.zeros_like(trial_average)\n' +
      '\x1B[32m     24\x1B[39m     ind_ses = \x1B[32m0\x1B[39m\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
16:56:22.031 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
16:56:22.049 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
16:56:22.063 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3c9c62d6aaf129aae7f34ad6b1dacd886bbcc73b1.json
    > cwd: //~/capsule/code
16:56:22.503 [info] Restarted ff7538e5-8c13-4ae6-a364-0686e6b30d84
16:56:29.018 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[1]\x1B[39m\x1B[32m, line 27\x1B[39m\n' +
      '\x1B[32m     24\x1B[39m max_epochs = \x1B[32m400000\x1B[39m\n' +
      '\x1B[32m     25\x1B[39m max_time_index = \x1B[32m275\x1B[39m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m27\x1B[39m \x1B[43mtrain\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43msub-442571_ses-20190228T140832.p\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m=\x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m=\x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m=\x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mlr\x1B[49m\x1B[43m=\x1B[49m\x1B[32;43m5e-4\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mtest_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m50\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43moptimize_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m1\x1B[39;49m\x1B[43m)\x1B[49m\n",
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/training.py:72\x1B[39m, in \x1B[36mtrain\x1B[39m\x1B[34m(files_list, session_names, net_params, n_pop, hemi, max_time_index, lr, max_epochs, test_every, optimize_every, info)\x1B[39m\n' +
      '\x1B[32m     70\x1B[39m     n_trials+=\x1B[38;5;28mlen\x1B[39m(trial_types[t_type])\n' +
      "\x1B[32m     71\x1B[39m default_parameters[\x1B[33m'\x1B[39m\x1B[33mn_trials\x1B[39m\x1B[33m'\x1B[39m] = n_trials\n" +
      '\x1B[32m---> \x1B[39m\x1B[32m72\x1B[39m net = \x1B[43mSingleTrialLicks\x1B[49m\x1B[43m(\x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     73\x1B[39m net.device = default_parameters[\x1B[33m'\x1B[39m\x1B[33mdevice\x1B[39m\x1B[33m'\x1B[39m]\n" +
      '\x1B[32m     74\x1B[39m \x1B[38;5;28;01mif\x1B[39;00m net_params \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/model.py:61\x1B[39m, in \x1B[36mSingleTrialLicks.__init__\x1B[39m\x1B[34m(self, params_dict, indexes_neurons_st)\x1B[39m\n' +
      '\x1B[32m     58\x1B[39m \x1B[38;5;28mself\x1B[39m.build_communication_recurrent()\n' +
      '\x1B[32m     60\x1B[39m \x1B[38;5;66;03m#perturbing the model\x1B[39;00m\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m61\x1B[39m \x1B[38;5;28mself\x1B[39m.input_test = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mzeros\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mn_neurons_alm\x1B[49m\x1B[43m)\x1B[49m\x1B[43m.\x1B[49m\x1B[43mto\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m.\x1B[49m\x1B[43mdevice\x1B[49m\x1B[43m)\x1B[49m     \n' +
      '\x1B[32m     62\x1B[39m \x1B[38;5;28mself\x1B[39m.to(\x1B[38;5;28mself\x1B[39m.device)\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
17:00:42.715 [warn] Cell completed with errors [iu [Error]: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'CUDA error: device-side assert triggered\n' +
    'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
    'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
    'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[2]\x1B[39m\x1B[32m, line 26\x1B[39m\n' +
      '\x1B[32m     24\x1B[39m max_epochs = \x1B[32m400000\x1B[39m\n' +
      '\x1B[32m     25\x1B[39m max_time_index = \x1B[32m275\x1B[39m\n' +
      '\x1B[32m---> \x1B[39m\x1B[32m26\x1B[39m ALM_hemi= \x1B[43mload_me_data\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m=\x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m=\x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m)\x1B[49m\n' +
      "\x1B[32m     27\x1B[39m \x1B[38;5;66;03m#train(files_list, session_names = ['sub-442571_ses-20190228T140832.p'], net_params=net_params, n_pop=n_pop, hemi=hemi, max_time_index =max_time_index,  lr=5e-4, max_epochs = max_epochs,  test_every = 50,  optimize_every = 1)\x1B[39;00m\n",
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:136\x1B[39m, in \x1B[36mload_me_data\x1B[39m\x1B[34m(list_sessions, default_parameters, hemi, max_time_index)\x1B[39m\n' +
      '\x1B[32m    134\x1B[39m n_trials = number_of_trials(list_sessions)\n' +
      '\x1B[32m    135\x1B[39m trial_types = lists_of_trial_types(list_sessions)\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m136\x1B[39m time_av = \x1B[43mtime_averages\x1B[49m\x1B[43m(\x1B[49m\x1B[43mlist_sessions\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[32m    137\x1B[39m neurons_av = neurons_averages(list_sessions, default_parameters)\n' +
      '\x1B[32m    138\x1B[39m responses = lists_of_responses(list_sessions)\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/utils.py:83\x1B[39m, in \x1B[36mtime_averages\x1B[39m\x1B[34m(list_sessions, default_parameters, hemi)\x1B[39m\n' +
      '\x1B[32m     81\x1B[39m         indexes_neurons = indexes_right\n' +
      "\x1B[32m     82\x1B[39m     t_average = np.einsum(\x1B[33m'\x1B[39m\x1B[33mijk->kij\x1B[39m\x1B[33m'\x1B[39m, data[\x1B[33m'\x1B[39m\x1B[33maverage_time\x1B[39m\x1B[33m'\x1B[39m][:,indexes_neurons,:]) \x1B[38;5;66;03m#neuron,condition, trial->condition, trial, neuron\x1B[39;00m\n" +
      "\x1B[32m---> \x1B[39m\x1B[32m83\x1B[39m     t_average = \x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mtensor\x1B[49m\x1B[43m(\x1B[49m\x1B[43mt_average\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mtch\x1B[49m\x1B[43m.\x1B[49m\x1B[43mfloat32\x1B[49m\x1B[43m)\x1B[49m\x1B[43m.\x1B[49m\x1B[43mto\x1B[49m\x1B[43m(\x1B[49m\x1B[43mdefault_parameters\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mdevice\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m.float()\n" +
      '\x1B[32m     84\x1B[39m     time_averages[file] = t_average\n' +
      '\x1B[32m     85\x1B[39m \x1B[38;5;28;01mreturn\x1B[39;00m time_averages\n',
    '\x1B[31mRuntimeError\x1B[39m: CUDA error: device-side assert triggered\n' +
      'CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\n' +
      'For debugging consider passing CUDA_LAUNCH_BLOCKING=1\n' +
      'Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n'
  ]
}
17:00:50.918 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
17:00:50.934 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
17:00:50.946 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v389b415879adf8834f5f6c7adbe16e743a2cf1b51.json
    > cwd: //~/capsule/code
17:00:51.387 [info] Restarted ff7538e5-8c13-4ae6-a364-0686e6b30d84
17:05:12.250 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
17:05:13.845 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
17:05:13.852 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3301cf8eafaa06f35a55daee55f0e45e57ee6e29a.json
    > cwd: //~/capsule/code
17:05:14.336 [info] Restarted ff7538e5-8c13-4ae6-a364-0686e6b30d84
17:05:16.727 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
17:05:16.741 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
17:05:16.751 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3c2a6d3cf35d410aef0bb74fbbdf84bd9c38c8d9d.json
    > cwd: //~/capsule/code
17:05:17.194 [info] Restarted ff7538e5-8c13-4ae6-a364-0686e6b30d84
17:05:22.467 [warn] Cell completed with errors [iu [Error]: The size of tensor a (124) must match the size of tensor b (102) at non-singleton dimension 2
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'The size of tensor a (124) must match the size of tensor b (102) at non-singleton dimension 2',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[1]\x1B[39m\x1B[32m, line 27\x1B[39m\n' +
      '\x1B[32m     25\x1B[39m max_time_index = \x1B[32m275\x1B[39m\n' +
      '\x1B[32m     26\x1B[39m \x1B[38;5;66;03m#ALM_hemi= load_me_data(files_list, default_parameters, hemi=hemi, max_time_index=max_time_index)\x1B[39;00m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m27\x1B[39m \x1B[43mtrain\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43msub-442571_ses-20190228T140832.p\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m=\x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m=\x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m=\x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mlr\x1B[49m\x1B[43m=\x1B[49m\x1B[32;43m5e-4\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mtest_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m50\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43moptimize_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m1\x1B[39;49m\x1B[43m)\x1B[49m\n",
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/training.py:95\x1B[39m, in \x1B[36mtrain\x1B[39m\x1B[34m(files_list, session_names, net_params, n_pop, hemi, max_time_index, lr, max_epochs, test_every, optimize_every, info)\x1B[39m\n' +
      '\x1B[32m     92\x1B[39m total_time_average = \x1B[32m0\x1B[39m\n' +
      '\x1B[32m     93\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mrange\x1B[39m(\x1B[38;5;28mlen\x1B[39m(session_names)):\n' +
      '\x1B[32m     94\x1B[39m     \x1B[38;5;66;03m#trial indexes to compute\x1B[39;00m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m95\x1B[39m     total_time_average += \x1B[43mListLossesTime\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m(\x1B[49m\x1B[43msingle_trials_activity\x1B[49m\x1B[43m[\x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m\n" +
      '\x1B[32m     96\x1B[39m total_time_average = total_time_average/\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n' +
      '\x1B[32m     97\x1B[39m losses_time_av[epoch] = total_time_average .detach().cpu().numpy()\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/losses.py:209\x1B[39m, in \x1B[36mLossAverageTime.__call__\x1B[39m\x1B[34m(self, rates_data, rates_model)\x1B[39m\n' +
      '\x1B[32m    207\x1B[39m av_time_data = \x1B[38;5;28mself\x1B[39m.compute_time_averages_3(rates_data)\n' +
      '\x1B[32m    208\x1B[39m \x1B[38;5;66;03m#calculating losses\x1B[39;00m\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m209\x1B[39m total_loss = tch.mean(tch.square(\x1B[43mav_time_data\x1B[49m\x1B[43m \x1B[49m\x1B[43m-\x1B[49m\x1B[43m \x1B[49m\x1B[43mav_time_model\x1B[49m))\n' +
      '\x1B[32m    210\x1B[39m \x1B[38;5;28;01mreturn\x1B[39;00m total_loss\n',
    '\x1B[31mRuntimeError\x1B[39m: The size of tensor a (124) must match the size of tensor b (102) at non-singleton dimension 2'
  ]
}
17:07:03.907 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
17:07:03.924 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
17:07:03.936 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v37305d39e2d03980db21946ccab3472812462feb1.json
    > cwd: //~/capsule/code
17:07:04.377 [info] Restarted ff7538e5-8c13-4ae6-a364-0686e6b30d84
17:07:11.260 [warn] Cell completed with errors [iu [Error]: The size of tensor a (124) must match the size of tensor b (102) at non-singleton dimension 2
	at n.execute (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:297:4958)] {
  ename: 'RuntimeError',
  evalue: 'The size of tensor a (124) must match the size of tensor b (102) at non-singleton dimension 2',
  traceback: [
    '\x1B[31m---------------------------------------------------------------------------\x1B[39m',
    '\x1B[31mRuntimeError\x1B[39m                              Traceback (most recent call last)',
    '\x1B[36mCell\x1B[39m\x1B[36m \x1B[39m\x1B[32mIn[1]\x1B[39m\x1B[32m, line 27\x1B[39m\n' +
      '\x1B[32m     25\x1B[39m max_time_index = \x1B[32m275\x1B[39m\n' +
      '\x1B[32m     26\x1B[39m \x1B[38;5;66;03m#ALM_hemi= load_me_data(files_list, default_parameters, hemi=hemi, max_time_index=max_time_index)\x1B[39;00m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m27\x1B[39m \x1B[43mtrain\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfiles_list\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43msub-442571_ses-20190228T140832.p\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m=\x1B[49m\x1B[43mnet_params\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m=\x1B[49m\x1B[43mn_pop\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m=\x1B[49m\x1B[43mhemi\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43mmax_time_index\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mlr\x1B[49m\x1B[43m=\x1B[49m\x1B[32;43m5e-4\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[43mmax_epochs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43mtest_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m50\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m  \x1B[49m\x1B[43moptimize_every\x1B[49m\x1B[43m \x1B[49m\x1B[43m=\x1B[49m\x1B[43m \x1B[49m\x1B[32;43m1\x1B[39;49m\x1B[43m)\x1B[49m\n",
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/training.py:95\x1B[39m, in \x1B[36mtrain\x1B[39m\x1B[34m(files_list, session_names, net_params, n_pop, hemi, max_time_index, lr, max_epochs, test_every, optimize_every, info)\x1B[39m\n' +
      '\x1B[32m     92\x1B[39m total_time_average = \x1B[32m0\x1B[39m\n' +
      '\x1B[32m     93\x1B[39m \x1B[38;5;28;01mfor\x1B[39;00m s \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mrange\x1B[39m(\x1B[38;5;28mlen\x1B[39m(session_names)):\n' +
      '\x1B[32m     94\x1B[39m     \x1B[38;5;66;03m#trial indexes to compute\x1B[39;00m\n' +
      "\x1B[32m---> \x1B[39m\x1B[32m95\x1B[39m     total_time_average += \x1B[43mListLossesTime\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m(\x1B[49m\x1B[43msingle_trials_activity\x1B[49m\x1B[43m[\x1B[49m\x1B[43msession_names\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mresults\x1B[49m\x1B[43m[\x1B[49m\x1B[33;43m'\x1B[39;49m\x1B[33;43mrates_trials\x1B[39;49m\x1B[33;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[43m[\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43m:\x1B[49m\x1B[43m,\x1B[49m\x1B[43mindexes_neurons_st\x1B[49m\x1B[43m[\x1B[49m\x1B[43ms\x1B[49m\x1B[43m]\x1B[49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m\n" +
      '\x1B[32m     96\x1B[39m total_time_average = total_time_average/\x1B[38;5;28mfloat\x1B[39m(total_sessions)\n' +
      '\x1B[32m     97\x1B[39m losses_time_av[epoch] = total_time_average .detach().cpu().numpy()\n',
    '\x1B[36mFile \x1B[39m\x1B[32m~/capsule/code/losses.py:210\x1B[39m, in \x1B[36mLossAverageTime.__call__\x1B[39m\x1B[34m(self, rates_data, rates_model)\x1B[39m\n' +
      '\x1B[32m    208\x1B[39m \x1B[38;5;28mprint\x1B[39m(rates_data.shape, rates_model.shape)\n' +
      '\x1B[32m    209\x1B[39m \x1B[38;5;66;03m#calculating losses\x1B[39;00m\n' +
      '\x1B[32m--> \x1B[39m\x1B[32m210\x1B[39m total_loss = tch.mean(tch.square(\x1B[43mav_time_data\x1B[49m\x1B[43m \x1B[49m\x1B[43m-\x1B[49m\x1B[43m \x1B[49m\x1B[43mav_time_model\x1B[49m))\n' +
      '\x1B[32m    211\x1B[39m \x1B[38;5;28;01mreturn\x1B[39;00m total_loss\n',
    '\x1B[31mRuntimeError\x1B[39m: The size of tensor a (124) must match the size of tensor b (102) at non-singleton dimension 2'
  ]
}
17:21:31.142 [info] Restart requested ~/capsule/code/testing_code_training.ipynb
17:21:32.750 [info] Process Execution: /opt/conda/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
17:21:32.757 [info] Process Execution: /opt/conda/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v3585da972c50ff62e017c694db846ff0b6bb5b9dd.json
    > cwd: //~/capsule/code
17:21:33.236 [info] Restarted ff7538e5-8c13-4ae6-a364-0686e6b30d84
17:21:42.982 [info] Interrupt kernel execution
17:21:42.983 [info] Interrupt requested ~/capsule/code/testing_code_training.ipynb
17:21:42.983 [info] Interrupt kernel execution
17:21:42.983 [info] Interrupting kernel: python3124jvsc74a57bd0d4d1e4263499bec80672ea0156c357c1ee493ec2b1c70f0acce89fc37c4a6abe
17:21:42.983 [info] Interrupting kernel via SIGINT
17:21:43.418 [warn] Cell completed with errors (cancelled)
17:21:43.419 [info] Interrupt requested & sent for ~/capsule/code/testing_code_training.ipynb in notebookEditor.
17:22:17.837 [info] Dispose Kernel '~/capsule/code/testing_code_training.ipynb' associated with '~/capsule/code/testing_code_training.ipynb'
17:22:17.837 [info] Dispose Kernel '~/capsule/code/testing_code_training.ipynb' associated with '~/capsule/code/testing_code_training.ipynb'
17:22:17.866 [warn] Failed to delete connection file file:///~/.local/share/jupyter/runtime/kernel-v3585da972c50ff62e017c694db846ff0b6bb5b9dd.json for pid 22891 [Canceled (FileSystemError): Canceled
	at Qi.e (file:///.code-server/code-server-4.95.3-linux-amd64/lib/vscode/out/vs/workbench/api/node/extensionHostProcess.js:114:9853)
	at Object.stat (file:///.code-server/code-server-4.95.3-linux-amd64/lib/vscode/out/vs/workbench/api/node/extensionHostProcess.js:114:7007)
	at async Bc.delete (/.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:239:15448)
	at async /.vscode/extensions/ms-toolsai.jupyter-2024.10.0-universal/dist/extension.node.js:303:469] {
  code: 'Unknown'
}
